Singularity> bash multi_task_train.sh
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[W socket.cpp:334] The server socket cannot be initialized on [::]:29500 (generic error: 97 - Address family not supported by protocol).
[W socket.cpp:490] The client socket cannot be initialized to connect to ?UNKNOWN? (generic error: 97 - Address family not supported by protocol).
[W socket.cpp:490] The client socket cannot be initialized to connect to ?UNKNOWN? (generic error: 97 - Address family not supported by protocol).
[W socket.cpp:490] The client socket cannot be initialized to connect to ?UNKNOWN? (generic error: 97 - Address family not supported by protocol).
[W socket.cpp:490] The client socket cannot be initialized to connect to ?UNKNOWN? (generic error: 97 - Address family not supported by protocol).
[W socket.cpp:490] The client socket cannot be initialized to connect to ?UNKNOWN? (generic error: 97 - Address family not supported by protocol).
[W socket.cpp:490] The client socket cannot be initialized to connect to ?UNKNOWN? (generic error: 97 - Address family not supported by protocol).
[W socket.cpp:490] The client socket cannot be initialized to connect to ?UNKNOWN? (generic error: 97 - Address family not supported by protocol).
[W socket.cpp:490] The client socket cannot be initialized to connect to ?UNKNOWN? (generic error: 97 - Address family not supported by protocol).
[W socket.cpp:490] The client socket cannot be initialized to connect to ?UNKNOWN? (generic error: 97 - Address family not supported by protocol).
[W socket.cpp:490] The client socket cannot be initialized to connect to ?UNKNOWN? (generic error: 97 - Address family not supported by protocol).
2023-09-07 08:00:49,312: Options: {'image_model_name': 'microsoft/swinv2-base-patch4-window8-256', 'image_model_train': False, 'language_model_name': 'google/flan-t5-base', 'ffn': False, 'transformer_d_model': 512, 'transformer_d_ff': 2048, 'transformer_d_kv': 64, 'transformer_num_heads': 2, 'transformer_num_layers': 8, 'transformer_num_decoder_layers': 8, 'image_vocab_size': 16384, 'loc_vocab_size': 1000, 'vae_ckpt_path': 'checkpoints/vqgan.pt', 'max_source_length': 256, 'max_target_length': 256, 'pretrain': False, 'seed': 999, 'loss': 'FocalLoss', 'lr': 0.01, 'optimizer': 'AdamW', 'lr_scheduler': '', 'batch_size': 64, 'accumulation_steps': 1, 'num_epochs': 2, 'num_steps': None, 'warmup_steps': None, 'save_interval': None, 'datasets': ['imagenet', 'sun397'], 'root_dir': '/user/data/', 'result_dir': 'results/multi_task_train/', 'gpu_nums': 4}
2023-09-07 08:00:49,314: make_logger
2023-09-07 08:00:49,319: Options: {'image_model_name': 'microsoft/swinv2-base-patch4-window8-256', 'image_model_train': False, 'language_model_name': 'google/flan-t5-base', 'ffn': False, 'transformer_d_model': 512, 'transformer_d_ff': 2048, 'transformer_d_kv': 64, 'transformer_num_heads': 2, 'transformer_num_layers': 8, 'transformer_num_decoder_layers': 8, 'image_vocab_size': 16384, 'loc_vocab_size': 1000, 'vae_ckpt_path': 'checkpoints/vqgan.pt', 'max_source_length': 256, 'max_target_length': 256, 'pretrain': False, 'seed': 999, 'loss': 'FocalLoss', 'lr': 0.01, 'optimizer': 'AdamW', 'lr_scheduler': '', 'batch_size': 64, 'accumulation_steps': 1, 'num_epochs': 2, 'num_steps': None, 'warmup_steps': None, 'save_interval': None, 'datasets': ['imagenet', 'sun397'], 'root_dir': '/user/data/', 'result_dir': 'results/multi_task_train/', 'gpu_nums': 4}
2023-09-07 08:00:49,319: make_logger
2023-09-07 08:00:49,319: Options: {'image_model_name': 'microsoft/swinv2-base-patch4-window8-256', 'image_model_train': False, 'language_model_name': 'google/flan-t5-base', 'ffn': False, 'transformer_d_model': 512, 'transformer_d_ff': 2048, 'transformer_d_kv': 64, 'transformer_num_heads': 2, 'transformer_num_layers': 8, 'transformer_num_decoder_layers': 8, 'image_vocab_size': 16384, 'loc_vocab_size': 1000, 'vae_ckpt_path': 'checkpoints/vqgan.pt', 'max_source_length': 256, 'max_target_length': 256, 'pretrain': False, 'seed': 999, 'loss': 'FocalLoss', 'lr': 0.01, 'optimizer': 'AdamW', 'lr_scheduler': '', 'batch_size': 64, 'accumulation_steps': 1, 'num_epochs': 2, 'num_steps': None, 'warmup_steps': None, 'save_interval': None, 'datasets': ['imagenet', 'sun397'], 'root_dir': '/user/data/', 'result_dir': 'results/multi_task_train/', 'gpu_nums': 4}
2023-09-07 08:00:49,319: make_logger
2023-09-07 08:00:49,319: Options: {'image_model_name': 'microsoft/swinv2-base-patch4-window8-256', 'image_model_train': False, 'language_model_name': 'google/flan-t5-base', 'ffn': False, 'transformer_d_model': 512, 'transformer_d_ff': 2048, 'transformer_d_kv': 64, 'transformer_num_heads': 2, 'transformer_num_layers': 8, 'transformer_num_decoder_layers': 8, 'image_vocab_size': 16384, 'loc_vocab_size': 1000, 'vae_ckpt_path': 'checkpoints/vqgan.pt', 'max_source_length': 256, 'max_target_length': 256, 'pretrain': False, 'seed': 999, 'loss': 'FocalLoss', 'lr': 0.01, 'optimizer': 'AdamW', 'lr_scheduler': '', 'batch_size': 64, 'accumulation_steps': 1, 'num_epochs': 2, 'num_steps': None, 'warmup_steps': None, 'save_interval': None, 'datasets': ['imagenet', 'sun397'], 'root_dir': '/user/data/', 'result_dir': 'results/multi_task_train/', 'gpu_nums': 4}
2023-09-07 08:00:49,319: make_logger
2023-09-07 08:00:56,988: rank:1 || start training
2023-09-07 08:00:56,988: min_step: 6, max_step: 7
2023-09-07 08:00:56,988: rank:2 || start training
2023-09-07 08:00:56,988: rank:0 || start training
2023-09-07 08:00:56,988: min_step: 6, max_step: 7
2023-09-07 08:00:56,988: min_step: 6, max_step: 7
2023-09-07 08:00:56,988: rank:3 || start training
2023-09-07 08:00:56,988: min_step: 6, max_step: 7
2023-09-07 08:00:57,388: epoch:1 step:1 rank:0 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
2023-09-07 08:00:57,414: epoch:1 step:1 rank:0 || image:[tensor([10.0000, 10.0004], device='cuda:0'), tensor([20.0000, 20.0004], device='cuda:0')] || in_text:[tensor([11.0000, 11.0004], device='cuda:0'), tensor([21.0000, 21.0004], device='cuda:0')] || out_text:[tensor([12.0000, 12.0004], device='cuda:0'), tensor([22.0000, 22.0004], device='cuda:0')]
2023-09-07 08:00:57,447: epoch:1 step:1 rank:3 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
2023-09-07 08:00:57,450: epoch:1 step:1 rank:2 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
2023-09-07 08:00:57,454: epoch:1 step:1 rank:1 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
2023-09-07 08:00:57,458: epoch:1 step:1 rank:2 || image:[tensor([10.0002, 10.0006], device='cuda:2'), tensor([20.0002, 20.0006], device='cuda:2')] || in_text:[tensor([11.0002, 11.0006], device='cuda:2'), tensor([21.0002, 21.0006], device='cuda:2')] || out_text:[tensor([12.0002, 12.0006], device='cuda:2'), tensor([22.0002, 22.0006], device='cuda:2')]
2023-09-07 08:00:57,460: epoch:1 step:1 rank:3 || image:[tensor([10.0003, 10.0007], device='cuda:3'), tensor([20.0003, 20.0007], device='cuda:3')] || in_text:[tensor([11.0003, 11.0007], device='cuda:3'), tensor([21.0003, 21.0007], device='cuda:3')] || out_text:[tensor([12.0003, 12.0007], device='cuda:3'), tensor([22.0003, 22.0007], device='cuda:3')]
2023-09-07 08:00:57,464: epoch:1 step:1 rank:1 || image:[tensor([10.0001, 10.0005], device='cuda:1'), tensor([20.0001, 20.0005], device='cuda:1')] || in_text:[tensor([11.0001, 11.0005], device='cuda:1'), tensor([21.0001, 21.0005], device='cuda:1')] || out_text:[tensor([12.0001, 12.0005], device='cuda:1'), tensor([22.0001, 22.0005], device='cuda:1')]
2023-09-07 08:01:02,752: epoch:1 step:2 rank:2 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
2023-09-07 08:01:02,752: epoch:1 step:2 rank:0 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
2023-09-07 08:01:02,752: epoch:1 step:2 rank:1 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
2023-09-07 08:01:02,753: epoch:1 step:2 rank:3 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
2023-09-07 08:01:02,755: epoch:1 step:2 rank:0 || image:[tensor([10.0060, 10.0064], device='cuda:0'), tensor([20.0200, 20.0204], device='cuda:0')] || in_text:[tensor([11.0060, 11.0064], device='cuda:0'), tensor([21.0200, 21.0204], device='cuda:0')] || out_text:[tensor([12.0060, 12.0064], device='cuda:0'), tensor([22.0200, 22.0204], device='cuda:0')]
2023-09-07 08:01:02,755: epoch:1 step:2 rank:1 || image:[tensor([10.0061, 10.0065], device='cuda:1'), tensor([20.0201, 20.0205], device='cuda:1')] || in_text:[tensor([11.0061, 11.0065], device='cuda:1'), tensor([21.0201, 21.0205], device='cuda:1')] || out_text:[tensor([12.0061, 12.0065], device='cuda:1'), tensor([22.0201, 22.0205], device='cuda:1')]
2023-09-07 08:01:02,755: epoch:1 step:2 rank:2 || image:[tensor([10.0062, 10.0066], device='cuda:2'), tensor([20.0202, 20.0206], device='cuda:2')] || in_text:[tensor([11.0062, 11.0066], device='cuda:2'), tensor([21.0202, 21.0206], device='cuda:2')] || out_text:[tensor([12.0062, 12.0066], device='cuda:2'), tensor([22.0202, 22.0206], device='cuda:2')]
2023-09-07 08:01:02,755: epoch:1 step:2 rank:3 || image:[tensor([10.0063, 10.0067], device='cuda:3'), tensor([20.0203, 20.0207], device='cuda:3')] || in_text:[tensor([11.0063, 11.0067], device='cuda:3'), tensor([21.0203, 21.0207], device='cuda:3')] || out_text:[tensor([12.0063, 12.0067], device='cuda:3'), tensor([22.0203, 22.0207], device='cuda:3')]
2023-09-07 08:01:02,761: epoch:1 step:3 rank:3 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
2023-09-07 08:01:02,761: epoch:1 step:3 rank:0 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
2023-09-07 08:01:02,761: epoch:1 step:3 rank:2 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
2023-09-07 08:01:02,761: epoch:1 step:3 rank:1 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
INFO:__main__:epoch:1 step:3 rank:3 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
INFO:__main__:epoch:1 step:3 rank:0 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
INFO:__main__:epoch:1 step:3 rank:2 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
INFO:__main__:epoch:1 step:3 rank:1 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
2023-09-07 08:01:02,764: epoch:1 step:3 rank:0 || image:[tensor([30.0020, 30.0024], device='cuda:0'), tensor([20.0400, 20.0404], device='cuda:0')] || in_text:[tensor([31.0020, 31.0024], device='cuda:0'), tensor([21.0400, 21.0404], device='cuda:0')] || out_text:[tensor([32.0020, 32.0024], device='cuda:0'), tensor([22.0400, 22.0404], device='cuda:0')]
2023-09-07 08:01:02,764: epoch:1 step:3 rank:3 || image:[tensor([30.0023, 30.0027], device='cuda:3'), tensor([20.0403, 20.0407], device='cuda:3')] || in_text:[tensor([31.0023, 31.0027], device='cuda:3'), tensor([21.0403, 21.0407], device='cuda:3')] || out_text:[tensor([32.0023, 32.0027], device='cuda:3'), tensor([22.0403, 22.0407], device='cuda:3')]
INFO:__main__:epoch:1 step:3 rank:0 || image:[tensor([30.0020, 30.0024], device='cuda:0'), tensor([20.0400, 20.0404], device='cuda:0')] || in_text:[tensor([31.0020, 31.0024], device='cuda:0'), tensor([21.0400, 21.0404], device='cuda:0')] || out_text:[tensor([32.0020, 32.0024], device='cuda:0'), tensor([22.0400, 22.0404], device='cuda:0')]
2023-09-07 08:01:02,764: epoch:1 step:3 rank:2 || image:[tensor([30.0022, 30.0026], device='cuda:2'), tensor([20.0402, 20.0406], device='cuda:2')] || in_text:[tensor([31.0022, 31.0026], device='cuda:2'), tensor([21.0402, 21.0406], device='cuda:2')] || out_text:[tensor([32.0022, 32.0026], device='cuda:2'), tensor([22.0402, 22.0406], device='cuda:2')]
INFO:__main__:epoch:1 step:3 rank:3 || image:[tensor([30.0023, 30.0027], device='cuda:3'), tensor([20.0403, 20.0407], device='cuda:3')] || in_text:[tensor([31.0023, 31.0027], device='cuda:3'), tensor([21.0403, 21.0407], device='cuda:3')] || out_text:[tensor([32.0023, 32.0027], device='cuda:3'), tensor([22.0403, 22.0407], device='cuda:3')]
2023-09-07 08:01:02,764: epoch:1 step:3 rank:1 || image:[tensor([30.0021, 30.0025], device='cuda:1'), tensor([20.0401, 20.0405], device='cuda:1')] || in_text:[tensor([31.0021, 31.0025], device='cuda:1'), tensor([21.0401, 21.0405], device='cuda:1')] || out_text:[tensor([32.0021, 32.0025], device='cuda:1'), tensor([22.0401, 22.0405], device='cuda:1')]
INFO:__main__:epoch:1 step:3 rank:2 || image:[tensor([30.0022, 30.0026], device='cuda:2'), tensor([20.0402, 20.0406], device='cuda:2')] || in_text:[tensor([31.0022, 31.0026], device='cuda:2'), tensor([21.0402, 21.0406], device='cuda:2')] || out_text:[tensor([32.0022, 32.0026], device='cuda:2'), tensor([22.0402, 22.0406], device='cuda:2')]
INFO:__main__:epoch:1 step:3 rank:1 || image:[tensor([30.0021, 30.0025], device='cuda:1'), tensor([20.0401, 20.0405], device='cuda:1')] || in_text:[tensor([31.0021, 31.0025], device='cuda:1'), tensor([21.0401, 21.0405], device='cuda:1')] || out_text:[tensor([32.0021, 32.0025], device='cuda:1'), tensor([22.0401, 22.0405], device='cuda:1')]
2023-09-07 08:01:02,765: epoch:1 step:4 rank:2 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
2023-09-07 08:01:02,765: epoch:1 step:4 rank:0 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
INFO:__main__:epoch:1 step:4 rank:2 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
INFO:__main__:epoch:1 step:4 rank:0 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
2023-09-07 08:01:02,766: epoch:1 step:4 rank:1 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
2023-09-07 08:01:02,766: epoch:1 step:4 rank:3 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
INFO:__main__:epoch:1 step:4 rank:1 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
INFO:__main__:epoch:1 step:4 rank:3 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
2023-09-07 08:01:02,768: epoch:1 step:4 rank:0 || image:[tensor([30.0080, 30.0084], device='cuda:0'), tensor([20.0600, 20.0604], device='cuda:0')] || in_text:[tensor([31.0080, 31.0084], device='cuda:0'), tensor([21.0600, 21.0604], device='cuda:0')] || out_text:[tensor([32.0080, 32.0084], device='cuda:0'), tensor([22.0600, 22.0604], device='cuda:0')]
INFO:__main__:epoch:1 step:4 rank:0 || image:[tensor([30.0080, 30.0084], device='cuda:0'), tensor([20.0600, 20.0604], device='cuda:0')] || in_text:[tensor([31.0080, 31.0084], device='cuda:0'), tensor([21.0600, 21.0604], device='cuda:0')] || out_text:[tensor([32.0080, 32.0084], device='cuda:0'), tensor([22.0600, 22.0604], device='cuda:0')]
2023-09-07 08:01:02,768: epoch:1 step:4 rank:2 || image:[tensor([30.0082, 30.0086], device='cuda:2'), tensor([20.0602, 20.0606], device='cuda:2')] || in_text:[tensor([31.0082, 31.0086], device='cuda:2'), tensor([21.0602, 21.0606], device='cuda:2')] || out_text:[tensor([32.0082, 32.0086], device='cuda:2'), tensor([22.0602, 22.0606], device='cuda:2')]
INFO:__main__:epoch:1 step:4 rank:2 || image:[tensor([30.0082, 30.0086], device='cuda:2'), tensor([20.0602, 20.0606], device='cuda:2')] || in_text:[tensor([31.0082, 31.0086], device='cuda:2'), tensor([21.0602, 21.0606], device='cuda:2')] || out_text:[tensor([32.0082, 32.0086], device='cuda:2'), tensor([22.0602, 22.0606], device='cuda:2')]
2023-09-07 08:01:02,769: epoch:1 step:4 rank:1 || image:[tensor([30.0081, 30.0085], device='cuda:1'), tensor([20.0601, 20.0605], device='cuda:1')] || in_text:[tensor([31.0081, 31.0085], device='cuda:1'), tensor([21.0601, 21.0605], device='cuda:1')] || out_text:[tensor([32.0081, 32.0085], device='cuda:1'), tensor([22.0601, 22.0605], device='cuda:1')]
INFO:__main__:epoch:1 step:4 rank:1 || image:[tensor([30.0081, 30.0085], device='cuda:1'), tensor([20.0601, 20.0605], device='cuda:1')] || in_text:[tensor([31.0081, 31.0085], device='cuda:1'), tensor([21.0601, 21.0605], device='cuda:1')] || out_text:[tensor([32.0081, 32.0085], device='cuda:1'), tensor([22.0601, 22.0605], device='cuda:1')]
2023-09-07 08:01:02,769: epoch:1 step:4 rank:3 || image:[tensor([30.0083, 30.0087], device='cuda:3'), tensor([20.0603, 20.0607], device='cuda:3')] || in_text:[tensor([31.0083, 31.0087], device='cuda:3'), tensor([21.0603, 21.0607], device='cuda:3')] || out_text:[tensor([32.0083, 32.0087], device='cuda:3'), tensor([22.0603, 22.0607], device='cuda:3')]
INFO:__main__:epoch:1 step:4 rank:3 || image:[tensor([30.0083, 30.0087], device='cuda:3'), tensor([20.0603, 20.0607], device='cuda:3')] || in_text:[tensor([31.0083, 31.0087], device='cuda:3'), tensor([21.0603, 21.0607], device='cuda:3')] || out_text:[tensor([32.0083, 32.0087], device='cuda:3'), tensor([22.0603, 22.0607], device='cuda:3')]
2023-09-07 08:01:02,770: epoch:1 step:5 rank:2 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
2023-09-07 08:01:02,770: epoch:1 step:5 rank:0 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
INFO:__main__:epoch:1 step:5 rank:2 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
INFO:__main__:epoch:1 step:5 rank:0 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
2023-09-07 08:01:02,770: epoch:1 step:5 rank:1 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
2023-09-07 08:01:02,771: epoch:1 step:5 rank:3 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
INFO:__main__:epoch:1 step:5 rank:1 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
INFO:__main__:epoch:1 step:5 rank:3 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
2023-09-07 08:01:02,773: epoch:1 step:5 rank:0 || image:[tensor([30.0140, 30.0144], device='cuda:0'), tensor([20.0800, 20.0804], device='cuda:0')] || in_text:[tensor([31.0140, 31.0144], device='cuda:0'), tensor([21.0800, 21.0804], device='cuda:0')] || out_text:[tensor([32.0140, 32.0144], device='cuda:0'), tensor([22.0800, 22.0804], device='cuda:0')]
2023-09-07 08:01:02,773: epoch:1 step:5 rank:2 || image:[tensor([30.0142, 30.0146], device='cuda:2'), tensor([20.0802, 20.0806], device='cuda:2')] || in_text:[tensor([31.0142, 31.0146], device='cuda:2'), tensor([21.0802, 21.0806], device='cuda:2')] || out_text:[tensor([32.0142, 32.0146], device='cuda:2'), tensor([22.0802, 22.0806], device='cuda:2')]
INFO:__main__:epoch:1 step:5 rank:0 || image:[tensor([30.0140, 30.0144], device='cuda:0'), tensor([20.0800, 20.0804], device='cuda:0')] || in_text:[tensor([31.0140, 31.0144], device='cuda:0'), tensor([21.0800, 21.0804], device='cuda:0')] || out_text:[tensor([32.0140, 32.0144], device='cuda:0'), tensor([22.0800, 22.0804], device='cuda:0')]
INFO:__main__:epoch:1 step:5 rank:2 || image:[tensor([30.0142, 30.0146], device='cuda:2'), tensor([20.0802, 20.0806], device='cuda:2')] || in_text:[tensor([31.0142, 31.0146], device='cuda:2'), tensor([21.0802, 21.0806], device='cuda:2')] || out_text:[tensor([32.0142, 32.0146], device='cuda:2'), tensor([22.0802, 22.0806], device='cuda:2')]
2023-09-07 08:01:02,773: epoch:1 step:5 rank:1 || image:[tensor([30.0141, 30.0145], device='cuda:1'), tensor([20.0801, 20.0805], device='cuda:1')] || in_text:[tensor([31.0141, 31.0145], device='cuda:1'), tensor([21.0801, 21.0805], device='cuda:1')] || out_text:[tensor([32.0141, 32.0145], device='cuda:1'), tensor([22.0801, 22.0805], device='cuda:1')]
INFO:__main__:epoch:1 step:5 rank:1 || image:[tensor([30.0141, 30.0145], device='cuda:1'), tensor([20.0801, 20.0805], device='cuda:1')] || in_text:[tensor([31.0141, 31.0145], device='cuda:1'), tensor([21.0801, 21.0805], device='cuda:1')] || out_text:[tensor([32.0141, 32.0145], device='cuda:1'), tensor([22.0801, 22.0805], device='cuda:1')]
2023-09-07 08:01:02,773: epoch:1 step:5 rank:3 || image:[tensor([30.0143, 30.0147], device='cuda:3'), tensor([20.0803, 20.0807], device='cuda:3')] || in_text:[tensor([31.0143, 31.0147], device='cuda:3'), tensor([21.0803, 21.0807], device='cuda:3')] || out_text:[tensor([32.0143, 32.0147], device='cuda:3'), tensor([22.0803, 22.0807], device='cuda:3')]
INFO:__main__:epoch:1 step:5 rank:3 || image:[tensor([30.0143, 30.0147], device='cuda:3'), tensor([20.0803, 20.0807], device='cuda:3')] || in_text:[tensor([31.0143, 31.0147], device='cuda:3'), tensor([21.0803, 21.0807], device='cuda:3')] || out_text:[tensor([32.0143, 32.0147], device='cuda:3'), tensor([22.0803, 22.0807], device='cuda:3')]
2023-09-07 08:01:02,774: epoch:1 step:6 rank:0 || batch_size = image:torch.Size([40, 1]) || in_text:torch.Size([40, 1]) || out_text:torch.Size([40, 1])
2023-09-07 08:01:02,774: epoch:1 step:6 rank:2 || batch_size = image:torch.Size([40, 1]) || in_text:torch.Size([40, 1]) || out_text:torch.Size([40, 1])
INFO:__main__:epoch:1 step:6 rank:0 || batch_size = image:torch.Size([40, 1]) || in_text:torch.Size([40, 1]) || out_text:torch.Size([40, 1])
INFO:__main__:epoch:1 step:6 rank:2 || batch_size = image:torch.Size([40, 1]) || in_text:torch.Size([40, 1]) || out_text:torch.Size([40, 1])
2023-09-07 08:01:02,775: epoch:1 step:6 rank:1 || batch_size = image:torch.Size([40, 1]) || in_text:torch.Size([40, 1]) || out_text:torch.Size([40, 1])
INFO:__main__:epoch:1 step:6 rank:1 || batch_size = image:torch.Size([40, 1]) || in_text:torch.Size([40, 1]) || out_text:torch.Size([40, 1])
2023-09-07 08:01:02,775: epoch:1 step:6 rank:3 || batch_size = image:torch.Size([40, 1]) || in_text:torch.Size([40, 1]) || out_text:torch.Size([40, 1])
INFO:__main__:epoch:1 step:6 rank:3 || batch_size = image:torch.Size([40, 1]) || in_text:torch.Size([40, 1]) || out_text:torch.Size([40, 1])
2023-09-07 08:01:02,777: epoch:1 step:6 rank:0 || image:[tensor([30.0200, 30.0204], device='cuda:0'), tensor([20.1000, 20.1004], device='cuda:0')] || in_text:[tensor([31.0200, 31.0204], device='cuda:0'), tensor([21.1000, 21.1004], device='cuda:0')] || out_text:[tensor([32.0200, 32.0204], device='cuda:0'), tensor([22.1000, 22.1004], device='cuda:0')]
INFO:__main__:epoch:1 step:6 rank:0 || image:[tensor([30.0200, 30.0204], device='cuda:0'), tensor([20.1000, 20.1004], device='cuda:0')] || in_text:[tensor([31.0200, 31.0204], device='cuda:0'), tensor([21.1000, 21.1004], device='cuda:0')] || out_text:[tensor([32.0200, 32.0204], device='cuda:0'), tensor([22.1000, 22.1004], device='cuda:0')]
2023-09-07 08:01:02,777: epoch:1 step:6 rank:2 || image:[tensor([30.0202, 30.0206], device='cuda:2'), tensor([20.1002, 20.1006], device='cuda:2')] || in_text:[tensor([31.0202, 31.0206], device='cuda:2'), tensor([21.1002, 21.1006], device='cuda:2')] || out_text:[tensor([32.0202, 32.0206], device='cuda:2'), tensor([22.1002, 22.1006], device='cuda:2')]
INFO:__main__:epoch:1 step:6 rank:2 || image:[tensor([30.0202, 30.0206], device='cuda:2'), tensor([20.1002, 20.1006], device='cuda:2')] || in_text:[tensor([31.0202, 31.0206], device='cuda:2'), tensor([21.1002, 21.1006], device='cuda:2')] || out_text:[tensor([32.0202, 32.0206], device='cuda:2'), tensor([22.1002, 22.1006], device='cuda:2')]
2023-09-07 08:01:02,778: epoch:1 step:6 rank:1 || image:[tensor([30.0201, 30.0205], device='cuda:1'), tensor([20.1001, 20.1005], device='cuda:1')] || in_text:[tensor([31.0201, 31.0205], device='cuda:1'), tensor([21.1001, 21.1005], device='cuda:1')] || out_text:[tensor([32.0201, 32.0205], device='cuda:1'), tensor([22.1001, 22.1005], device='cuda:1')]
INFO:__main__:epoch:1 step:6 rank:1 || image:[tensor([30.0201, 30.0205], device='cuda:1'), tensor([20.1001, 20.1005], device='cuda:1')] || in_text:[tensor([31.0201, 31.0205], device='cuda:1'), tensor([21.1001, 21.1005], device='cuda:1')] || out_text:[tensor([32.0201, 32.0205], device='cuda:1'), tensor([22.1001, 22.1005], device='cuda:1')]
2023-09-07 08:01:02,778: epoch:1 step:6 rank:3 || image:[tensor([30.0203, 30.0207], device='cuda:3'), tensor([20.1003, 20.1007], device='cuda:3')] || in_text:[tensor([31.0203, 31.0207], device='cuda:3'), tensor([21.1003, 21.1007], device='cuda:3')] || out_text:[tensor([32.0203, 32.0207], device='cuda:3'), tensor([22.1003, 22.1007], device='cuda:3')]
INFO:__main__:epoch:1 step:6 rank:3 || image:[tensor([30.0203, 30.0207], device='cuda:3'), tensor([20.1003, 20.1007], device='cuda:3')] || in_text:[tensor([31.0203, 31.0207], device='cuda:3'), tensor([21.1003, 21.1007], device='cuda:3')] || out_text:[tensor([32.0203, 32.0207], device='cuda:3'), tensor([22.1003, 22.1007], device='cuda:3')]
2023-09-07 08:01:03,062: epoch:2 step:1 rank:3 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
INFO:__main__:epoch:2 step:1 rank:3 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
2023-09-07 08:01:03,067: epoch:2 step:1 rank:3 || image:[tensor([10.0003, 10.0007], device='cuda:3'), tensor([20.0003, 20.0007], device='cuda:3')] || in_text:[tensor([11.0003, 11.0007], device='cuda:3'), tensor([21.0003, 21.0007], device='cuda:3')] || out_text:[tensor([12.0003, 12.0007], device='cuda:3'), tensor([22.0003, 22.0007], device='cuda:3')]
INFO:__main__:epoch:2 step:1 rank:3 || image:[tensor([10.0003, 10.0007], device='cuda:3'), tensor([20.0003, 20.0007], device='cuda:3')] || in_text:[tensor([11.0003, 11.0007], device='cuda:3'), tensor([21.0003, 21.0007], device='cuda:3')] || out_text:[tensor([12.0003, 12.0007], device='cuda:3'), tensor([22.0003, 22.0007], device='cuda:3')]
2023-09-07 08:01:03,094: epoch:2 step:1 rank:0 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
INFO:__main__:epoch:2 step:1 rank:0 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
2023-09-07 08:01:03,095: epoch:2 step:1 rank:2 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
INFO:__main__:epoch:2 step:1 rank:2 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
2023-09-07 08:01:03,098: epoch:2 step:1 rank:0 || image:[tensor([10.0000, 10.0004], device='cuda:0'), tensor([20.0000, 20.0004], device='cuda:0')] || in_text:[tensor([11.0000, 11.0004], device='cuda:0'), tensor([21.0000, 21.0004], device='cuda:0')] || out_text:[tensor([12.0000, 12.0004], device='cuda:0'), tensor([22.0000, 22.0004], device='cuda:0')]
INFO:__main__:epoch:2 step:1 rank:0 || image:[tensor([10.0000, 10.0004], device='cuda:0'), tensor([20.0000, 20.0004], device='cuda:0')] || in_text:[tensor([11.0000, 11.0004], device='cuda:0'), tensor([21.0000, 21.0004], device='cuda:0')] || out_text:[tensor([12.0000, 12.0004], device='cuda:0'), tensor([22.0000, 22.0004], device='cuda:0')]
2023-09-07 08:01:03,101: epoch:2 step:1 rank:2 || image:[tensor([10.0002, 10.0006], device='cuda:2'), tensor([20.0002, 20.0006], device='cuda:2')] || in_text:[tensor([11.0002, 11.0006], device='cuda:2'), tensor([21.0002, 21.0006], device='cuda:2')] || out_text:[tensor([12.0002, 12.0006], device='cuda:2'), tensor([22.0002, 22.0006], device='cuda:2')]
INFO:__main__:epoch:2 step:1 rank:2 || image:[tensor([10.0002, 10.0006], device='cuda:2'), tensor([20.0002, 20.0006], device='cuda:2')] || in_text:[tensor([11.0002, 11.0006], device='cuda:2'), tensor([21.0002, 21.0006], device='cuda:2')] || out_text:[tensor([12.0002, 12.0006], device='cuda:2'), tensor([22.0002, 22.0006], device='cuda:2')]
2023-09-07 08:01:03,103: epoch:2 step:1 rank:1 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
INFO:__main__:epoch:2 step:1 rank:1 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
2023-09-07 08:01:03,107: epoch:2 step:1 rank:1 || image:[tensor([10.0001, 10.0005], device='cuda:1'), tensor([20.0001, 20.0005], device='cuda:1')] || in_text:[tensor([11.0001, 11.0005], device='cuda:1'), tensor([21.0001, 21.0005], device='cuda:1')] || out_text:[tensor([12.0001, 12.0005], device='cuda:1'), tensor([22.0001, 22.0005], device='cuda:1')]
INFO:__main__:epoch:2 step:1 rank:1 || image:[tensor([10.0001, 10.0005], device='cuda:1'), tensor([20.0001, 20.0005], device='cuda:1')] || in_text:[tensor([11.0001, 11.0005], device='cuda:1'), tensor([21.0001, 21.0005], device='cuda:1')] || out_text:[tensor([12.0001, 12.0005], device='cuda:1'), tensor([22.0001, 22.0005], device='cuda:1')]
2023-09-07 08:01:03,112: epoch:2 step:2 rank:0 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
2023-09-07 08:01:03,112: epoch:2 step:2 rank:2 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
INFO:__main__:epoch:2 step:2 rank:0 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
2023-09-07 08:01:03,112: epoch:2 step:2 rank:3 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
INFO:__main__:epoch:2 step:2 rank:2 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
INFO:__main__:epoch:2 step:2 rank:3 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
2023-09-07 08:01:03,113: epoch:2 step:2 rank:1 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
INFO:__main__:epoch:2 step:2 rank:1 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
2023-09-07 08:01:03,115: epoch:2 step:2 rank:0 || image:[tensor([10.0060, 10.0064], device='cuda:0'), tensor([20.0200, 20.0204], device='cuda:0')] || in_text:[tensor([11.0060, 11.0064], device='cuda:0'), tensor([21.0200, 21.0204], device='cuda:0')] || out_text:[tensor([12.0060, 12.0064], device='cuda:0'), tensor([22.0200, 22.0204], device='cuda:0')]
INFO:__main__:epoch:2 step:2 rank:0 || image:[tensor([10.0060, 10.0064], device='cuda:0'), tensor([20.0200, 20.0204], device='cuda:0')] || in_text:[tensor([11.0060, 11.0064], device='cuda:0'), tensor([21.0200, 21.0204], device='cuda:0')] || out_text:[tensor([12.0060, 12.0064], device='cuda:0'), tensor([22.0200, 22.0204], device='cuda:0')]
2023-09-07 08:01:03,115: epoch:2 step:2 rank:2 || image:[tensor([10.0062, 10.0066], device='cuda:2'), tensor([20.0202, 20.0206], device='cuda:2')] || in_text:[tensor([11.0062, 11.0066], device='cuda:2'), tensor([21.0202, 21.0206], device='cuda:2')] || out_text:[tensor([12.0062, 12.0066], device='cuda:2'), tensor([22.0202, 22.0206], device='cuda:2')]
INFO:__main__:epoch:2 step:2 rank:2 || image:[tensor([10.0062, 10.0066], device='cuda:2'), tensor([20.0202, 20.0206], device='cuda:2')] || in_text:[tensor([11.0062, 11.0066], device='cuda:2'), tensor([21.0202, 21.0206], device='cuda:2')] || out_text:[tensor([12.0062, 12.0066], device='cuda:2'), tensor([22.0202, 22.0206], device='cuda:2')]
2023-09-07 08:01:03,116: epoch:2 step:2 rank:3 || image:[tensor([10.0063, 10.0067], device='cuda:3'), tensor([20.0203, 20.0207], device='cuda:3')] || in_text:[tensor([11.0063, 11.0067], device='cuda:3'), tensor([21.0203, 21.0207], device='cuda:3')] || out_text:[tensor([12.0063, 12.0067], device='cuda:3'), tensor([22.0203, 22.0207], device='cuda:3')]
INFO:__main__:epoch:2 step:2 rank:3 || image:[tensor([10.0063, 10.0067], device='cuda:3'), tensor([20.0203, 20.0207], device='cuda:3')] || in_text:[tensor([11.0063, 11.0067], device='cuda:3'), tensor([21.0203, 21.0207], device='cuda:3')] || out_text:[tensor([12.0063, 12.0067], device='cuda:3'), tensor([22.0203, 22.0207], device='cuda:3')]
2023-09-07 08:01:03,117: epoch:2 step:2 rank:1 || image:[tensor([10.0061, 10.0065], device='cuda:1'), tensor([20.0201, 20.0205], device='cuda:1')] || in_text:[tensor([11.0061, 11.0065], device='cuda:1'), tensor([21.0201, 21.0205], device='cuda:1')] || out_text:[tensor([12.0061, 12.0065], device='cuda:1'), tensor([22.0201, 22.0205], device='cuda:1')]
INFO:__main__:epoch:2 step:2 rank:1 || image:[tensor([10.0061, 10.0065], device='cuda:1'), tensor([20.0201, 20.0205], device='cuda:1')] || in_text:[tensor([11.0061, 11.0065], device='cuda:1'), tensor([21.0201, 21.0205], device='cuda:1')] || out_text:[tensor([12.0061, 12.0065], device='cuda:1'), tensor([22.0201, 22.0205], device='cuda:1')]
2023-09-07 08:01:03,117: epoch:2 step:3 rank:0 ||  initialize rank:0 iterator 1
INFO:__main__:epoch:2 step:3 rank:0 ||  initialize rank:0 iterator 1
2023-09-07 08:01:03,118: epoch:2 step:3 rank:2 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
INFO:__main__:epoch:2 step:3 rank:2 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
2023-09-07 08:01:03,118: epoch:2 step:3 rank:3 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
INFO:__main__:epoch:2 step:3 rank:3 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
2023-09-07 08:01:03,118: epoch:2 step:3 rank:1 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
INFO:__main__:epoch:2 step:3 rank:1 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
2023-09-07 08:01:03,121: epoch:2 step:3 rank:2 || image:[tensor([30.0022, 30.0026], device='cuda:2'), tensor([20.0402, 20.0406], device='cuda:2')] || in_text:[tensor([31.0022, 31.0026], device='cuda:2'), tensor([21.0402, 21.0406], device='cuda:2')] || out_text:[tensor([32.0022, 32.0026], device='cuda:2'), tensor([22.0402, 22.0406], device='cuda:2')]
2023-09-07 08:01:03,121: epoch:2 step:3 rank:3 || image:[tensor([30.0023, 30.0027], device='cuda:3'), tensor([20.0403, 20.0407], device='cuda:3')] || in_text:[tensor([31.0023, 31.0027], device='cuda:3'), tensor([21.0403, 21.0407], device='cuda:3')] || out_text:[tensor([32.0023, 32.0027], device='cuda:3'), tensor([22.0403, 22.0407], device='cuda:3')]
INFO:__main__:epoch:2 step:3 rank:2 || image:[tensor([30.0022, 30.0026], device='cuda:2'), tensor([20.0402, 20.0406], device='cuda:2')] || in_text:[tensor([31.0022, 31.0026], device='cuda:2'), tensor([21.0402, 21.0406], device='cuda:2')] || out_text:[tensor([32.0022, 32.0026], device='cuda:2'), tensor([22.0402, 22.0406], device='cuda:2')]
INFO:__main__:epoch:2 step:3 rank:3 || image:[tensor([30.0023, 30.0027], device='cuda:3'), tensor([20.0403, 20.0407], device='cuda:3')] || in_text:[tensor([31.0023, 31.0027], device='cuda:3'), tensor([21.0403, 21.0407], device='cuda:3')] || out_text:[tensor([32.0023, 32.0027], device='cuda:3'), tensor([22.0403, 22.0407], device='cuda:3')]
2023-09-07 08:01:03,121: epoch:2 step:3 rank:1 || image:[tensor([30.0021, 30.0025], device='cuda:1'), tensor([20.0401, 20.0405], device='cuda:1')] || in_text:[tensor([31.0021, 31.0025], device='cuda:1'), tensor([21.0401, 21.0405], device='cuda:1')] || out_text:[tensor([32.0021, 32.0025], device='cuda:1'), tensor([22.0401, 22.0405], device='cuda:1')]
INFO:__main__:epoch:2 step:3 rank:1 || image:[tensor([30.0021, 30.0025], device='cuda:1'), tensor([20.0401, 20.0405], device='cuda:1')] || in_text:[tensor([31.0021, 31.0025], device='cuda:1'), tensor([21.0401, 21.0405], device='cuda:1')] || out_text:[tensor([32.0021, 32.0025], device='cuda:1'), tensor([22.0401, 22.0405], device='cuda:1')]
2023-09-07 08:01:03,244: epoch:2 step:3 rank:0 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
INFO:__main__:epoch:2 step:3 rank:0 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
2023-09-07 08:01:03,248: epoch:2 step:3 rank:0 || image:[tensor([30.0020, 30.0024], device='cuda:0'), tensor([20.0000, 20.0004], device='cuda:0')] || in_text:[tensor([31.0020, 31.0024], device='cuda:0'), tensor([21.0000, 21.0004], device='cuda:0')] || out_text:[tensor([32.0020, 32.0024], device='cuda:0'), tensor([22.0000, 22.0004], device='cuda:0')]
INFO:__main__:epoch:2 step:3 rank:0 || image:[tensor([30.0020, 30.0024], device='cuda:0'), tensor([20.0000, 20.0004], device='cuda:0')] || in_text:[tensor([31.0020, 31.0024], device='cuda:0'), tensor([21.0000, 21.0004], device='cuda:0')] || out_text:[tensor([32.0020, 32.0024], device='cuda:0'), tensor([22.0000, 22.0004], device='cuda:0')]
2023-09-07 08:01:03,252: epoch:2 step:4 rank:1 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
2023-09-07 08:01:03,252: epoch:2 step:4 rank:3 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
2023-09-07 08:01:03,252: epoch:2 step:4 rank:2 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
INFO:__main__:epoch:2 step:4 rank:1 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
INFO:__main__:epoch:2 step:4 rank:3 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
INFO:__main__:epoch:2 step:4 rank:2 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
2023-09-07 08:01:03,253: epoch:2 step:4 rank:0 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
INFO:__main__:epoch:2 step:4 rank:0 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
2023-09-07 08:01:03,255: epoch:2 step:4 rank:1 || image:[tensor([30.0081, 30.0085], device='cuda:1'), tensor([20.0601, 20.0605], device='cuda:1')] || in_text:[tensor([31.0081, 31.0085], device='cuda:1'), tensor([21.0601, 21.0605], device='cuda:1')] || out_text:[tensor([32.0081, 32.0085], device='cuda:1'), tensor([22.0601, 22.0605], device='cuda:1')]
2023-09-07 08:01:03,255: epoch:2 step:4 rank:3 || image:[tensor([30.0083, 30.0087], device='cuda:3'), tensor([20.0603, 20.0607], device='cuda:3')] || in_text:[tensor([31.0083, 31.0087], device='cuda:3'), tensor([21.0603, 21.0607], device='cuda:3')] || out_text:[tensor([32.0083, 32.0087], device='cuda:3'), tensor([22.0603, 22.0607], device='cuda:3')]
INFO:__main__:epoch:2 step:4 rank:1 || image:[tensor([30.0081, 30.0085], device='cuda:1'), tensor([20.0601, 20.0605], device='cuda:1')] || in_text:[tensor([31.0081, 31.0085], device='cuda:1'), tensor([21.0601, 21.0605], device='cuda:1')] || out_text:[tensor([32.0081, 32.0085], device='cuda:1'), tensor([22.0601, 22.0605], device='cuda:1')]
INFO:__main__:epoch:2 step:4 rank:3 || image:[tensor([30.0083, 30.0087], device='cuda:3'), tensor([20.0603, 20.0607], device='cuda:3')] || in_text:[tensor([31.0083, 31.0087], device='cuda:3'), tensor([21.0603, 21.0607], device='cuda:3')] || out_text:[tensor([32.0083, 32.0087], device='cuda:3'), tensor([22.0603, 22.0607], device='cuda:3')]
2023-09-07 08:01:03,255: epoch:2 step:4 rank:2 || image:[tensor([30.0082, 30.0086], device='cuda:2'), tensor([20.0602, 20.0606], device='cuda:2')] || in_text:[tensor([31.0082, 31.0086], device='cuda:2'), tensor([21.0602, 21.0606], device='cuda:2')] || out_text:[tensor([32.0082, 32.0086], device='cuda:2'), tensor([22.0602, 22.0606], device='cuda:2')]
INFO:__main__:epoch:2 step:4 rank:2 || image:[tensor([30.0082, 30.0086], device='cuda:2'), tensor([20.0602, 20.0606], device='cuda:2')] || in_text:[tensor([31.0082, 31.0086], device='cuda:2'), tensor([21.0602, 21.0606], device='cuda:2')] || out_text:[tensor([32.0082, 32.0086], device='cuda:2'), tensor([22.0602, 22.0606], device='cuda:2')]
2023-09-07 08:01:03,255: epoch:2 step:4 rank:0 || image:[tensor([30.0080, 30.0084], device='cuda:0'), tensor([20.0200, 20.0204], device='cuda:0')] || in_text:[tensor([31.0080, 31.0084], device='cuda:0'), tensor([21.0200, 21.0204], device='cuda:0')] || out_text:[tensor([32.0080, 32.0084], device='cuda:0'), tensor([22.0200, 22.0204], device='cuda:0')]
INFO:__main__:epoch:2 step:4 rank:0 || image:[tensor([30.0080, 30.0084], device='cuda:0'), tensor([20.0200, 20.0204], device='cuda:0')] || in_text:[tensor([31.0080, 31.0084], device='cuda:0'), tensor([21.0200, 21.0204], device='cuda:0')] || out_text:[tensor([32.0080, 32.0084], device='cuda:0'), tensor([22.0200, 22.0204], device='cuda:0')]
2023-09-07 08:01:03,257: epoch:2 step:5 rank:1 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
2023-09-07 08:01:03,257: epoch:2 step:5 rank:0 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
2023-09-07 08:01:03,257: epoch:2 step:5 rank:2 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
2023-09-07 08:01:03,257: epoch:2 step:5 rank:3 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
INFO:__main__:epoch:2 step:5 rank:1 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
INFO:__main__:epoch:2 step:5 rank:0 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
INFO:__main__:epoch:2 step:5 rank:2 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
INFO:__main__:epoch:2 step:5 rank:3 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
2023-09-07 08:01:03,259: epoch:2 step:5 rank:0 || image:[tensor([30.0140, 30.0144], device='cuda:0'), tensor([20.0400, 20.0404], device='cuda:0')] || in_text:[tensor([31.0140, 31.0144], device='cuda:0'), tensor([21.0400, 21.0404], device='cuda:0')] || out_text:[tensor([32.0140, 32.0144], device='cuda:0'), tensor([22.0400, 22.0404], device='cuda:0')]
INFO:__main__:epoch:2 step:5 rank:0 || image:[tensor([30.0140, 30.0144], device='cuda:0'), tensor([20.0400, 20.0404], device='cuda:0')] || in_text:[tensor([31.0140, 31.0144], device='cuda:0'), tensor([21.0400, 21.0404], device='cuda:0')] || out_text:[tensor([32.0140, 32.0144], device='cuda:0'), tensor([22.0400, 22.0404], device='cuda:0')]
2023-09-07 08:01:03,260: epoch:2 step:5 rank:1 || image:[tensor([30.0141, 30.0145], device='cuda:1'), tensor([20.0801, 20.0805], device='cuda:1')] || in_text:[tensor([31.0141, 31.0145], device='cuda:1'), tensor([21.0801, 21.0805], device='cuda:1')] || out_text:[tensor([32.0141, 32.0145], device='cuda:1'), tensor([22.0801, 22.0805], device='cuda:1')]
2023-09-07 08:01:03,260: epoch:2 step:5 rank:3 || image:[tensor([30.0143, 30.0147], device='cuda:3'), tensor([20.0803, 20.0807], device='cuda:3')] || in_text:[tensor([31.0143, 31.0147], device='cuda:3'), tensor([21.0803, 21.0807], device='cuda:3')] || out_text:[tensor([32.0143, 32.0147], device='cuda:3'), tensor([22.0803, 22.0807], device='cuda:3')]
2023-09-07 08:01:03,260: epoch:2 step:5 rank:2 || image:[tensor([30.0142, 30.0146], device='cuda:2'), tensor([20.0802, 20.0806], device='cuda:2')] || in_text:[tensor([31.0142, 31.0146], device='cuda:2'), tensor([21.0802, 21.0806], device='cuda:2')] || out_text:[tensor([32.0142, 32.0146], device='cuda:2'), tensor([22.0802, 22.0806], device='cuda:2')]
INFO:__main__:epoch:2 step:5 rank:1 || image:[tensor([30.0141, 30.0145], device='cuda:1'), tensor([20.0801, 20.0805], device='cuda:1')] || in_text:[tensor([31.0141, 31.0145], device='cuda:1'), tensor([21.0801, 21.0805], device='cuda:1')] || out_text:[tensor([32.0141, 32.0145], device='cuda:1'), tensor([22.0801, 22.0805], device='cuda:1')]
INFO:__main__:epoch:2 step:5 rank:3 || image:[tensor([30.0143, 30.0147], device='cuda:3'), tensor([20.0803, 20.0807], device='cuda:3')] || in_text:[tensor([31.0143, 31.0147], device='cuda:3'), tensor([21.0803, 21.0807], device='cuda:3')] || out_text:[tensor([32.0143, 32.0147], device='cuda:3'), tensor([22.0803, 22.0807], device='cuda:3')]
INFO:__main__:epoch:2 step:5 rank:2 || image:[tensor([30.0142, 30.0146], device='cuda:2'), tensor([20.0802, 20.0806], device='cuda:2')] || in_text:[tensor([31.0142, 31.0146], device='cuda:2'), tensor([21.0802, 21.0806], device='cuda:2')] || out_text:[tensor([32.0142, 32.0146], device='cuda:2'), tensor([22.0802, 22.0806], device='cuda:2')]
2023-09-07 08:01:03,261: epoch:2 step:6 rank:0 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
INFO:__main__:epoch:2 step:6 rank:0 || batch_size = image:torch.Size([65, 1]) || in_text:torch.Size([65, 1]) || out_text:torch.Size([65, 1])
2023-09-07 08:01:03,261: epoch:2 step:6 rank:1 || batch_size = image:torch.Size([40, 1]) || in_text:torch.Size([40, 1]) || out_text:torch.Size([40, 1])
INFO:__main__:epoch:2 step:6 rank:1 || batch_size = image:torch.Size([40, 1]) || in_text:torch.Size([40, 1]) || out_text:torch.Size([40, 1])
2023-09-07 08:01:03,261: epoch:2 step:6 rank:2 || batch_size = image:torch.Size([40, 1]) || in_text:torch.Size([40, 1]) || out_text:torch.Size([40, 1])
2023-09-07 08:01:03,261: epoch:2 step:6 rank:3 || batch_size = image:torch.Size([40, 1]) || in_text:torch.Size([40, 1]) || out_text:torch.Size([40, 1])
INFO:__main__:epoch:2 step:6 rank:2 || batch_size = image:torch.Size([40, 1]) || in_text:torch.Size([40, 1]) || out_text:torch.Size([40, 1])
INFO:__main__:epoch:2 step:6 rank:3 || batch_size = image:torch.Size([40, 1]) || in_text:torch.Size([40, 1]) || out_text:torch.Size([40, 1])
2023-09-07 08:01:03,263: epoch:2 step:6 rank:0 || image:[tensor([30.0200, 30.0204], device='cuda:0'), tensor([20.0600, 20.0604], device='cuda:0')] || in_text:[tensor([31.0200, 31.0204], device='cuda:0'), tensor([21.0600, 21.0604], device='cuda:0')] || out_text:[tensor([32.0200, 32.0204], device='cuda:0'), tensor([22.0600, 22.0604], device='cuda:0')]
INFO:__main__:epoch:2 step:6 rank:0 || image:[tensor([30.0200, 30.0204], device='cuda:0'), tensor([20.0600, 20.0604], device='cuda:0')] || in_text:[tensor([31.0200, 31.0204], device='cuda:0'), tensor([21.0600, 21.0604], device='cuda:0')] || out_text:[tensor([32.0200, 32.0204], device='cuda:0'), tensor([22.0600, 22.0604], device='cuda:0')]
2023-09-07 08:01:03,264: epoch:2 step:6 rank:3 || image:[tensor([30.0203, 30.0207], device='cuda:3'), tensor([20.1003, 20.1007], device='cuda:3')] || in_text:[tensor([31.0203, 31.0207], device='cuda:3'), tensor([21.1003, 21.1007], device='cuda:3')] || out_text:[tensor([32.0203, 32.0207], device='cuda:3'), tensor([22.1003, 22.1007], device='cuda:3')]
2023-09-07 08:01:03,264: epoch:2 step:6 rank:2 || image:[tensor([30.0202, 30.0206], device='cuda:2'), tensor([20.1002, 20.1006], device='cuda:2')] || in_text:[tensor([31.0202, 31.0206], device='cuda:2'), tensor([21.1002, 21.1006], device='cuda:2')] || out_text:[tensor([32.0202, 32.0206], device='cuda:2'), tensor([22.1002, 22.1006], device='cuda:2')]
2023-09-07 08:01:03,264: epoch:2 step:6 rank:1 || image:[tensor([30.0201, 30.0205], device='cuda:1'), tensor([20.1001, 20.1005], device='cuda:1')] || in_text:[tensor([31.0201, 31.0205], device='cuda:1'), tensor([21.1001, 21.1005], device='cuda:1')] || out_text:[tensor([32.0201, 32.0205], device='cuda:1'), tensor([22.1001, 22.1005], device='cuda:1')]
INFO:__main__:epoch:2 step:6 rank:3 || image:[tensor([30.0203, 30.0207], device='cuda:3'), tensor([20.1003, 20.1007], device='cuda:3')] || in_text:[tensor([31.0203, 31.0207], device='cuda:3'), tensor([21.1003, 21.1007], device='cuda:3')] || out_text:[tensor([32.0203, 32.0207], device='cuda:3'), tensor([22.1003, 22.1007], device='cuda:3')]
INFO:__main__:epoch:2 step:6 rank:2 || image:[tensor([30.0202, 30.0206], device='cuda:2'), tensor([20.1002, 20.1006], device='cuda:2')] || in_text:[tensor([31.0202, 31.0206], device='cuda:2'), tensor([21.1002, 21.1006], device='cuda:2')] || out_text:[tensor([32.0202, 32.0206], device='cuda:2'), tensor([22.1002, 22.1006], device='cuda:2')]
INFO:__main__:epoch:2 step:6 rank:1 || image:[tensor([30.0201, 30.0205], device='cuda:1'), tensor([20.1001, 20.1005], device='cuda:1')] || in_text:[tensor([31.0201, 31.0205], device='cuda:1'), tensor([21.1001, 21.1005], device='cuda:1')] || out_text:[tensor([32.0201, 32.0205], device='cuda:1'), tensor([22.1001, 22.1005], device='cuda:1')]
